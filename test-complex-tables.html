<!DOCTYPE html>
<html>
<head>
    <title>Complex Table Structure Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 40px;
            background: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        table {
            border-collapse: collapse;
            margin: 15px 0;
            width: 100%;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ðŸ“… Complex Table Structure Test - September Calendar</h1>
    
    <div class="test-section">
        <h3>Original Problem Table</h3>
        <p>This is the exact table structure that was being cleaned incorrectly:</p>
        
        <table class="table table-hover table-bordered">
        <tbody>
           <tr>
              <th colspan="6"><h2>Septiembre</h2></th>
           </tr>
        <tr>
        <th width="40"><strong>1</strong></th>
        <td width="200">39.394,46</td>
        <th width="40"><strong>11</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>21</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>2</strong></th>
        <td width="200">39.405,85</td>
        <th width="40"><strong>12</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>22</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>3</strong></th>
        <td width="200">39.417,24</td>
        <th width="40"><strong>13</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>23</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>4</strong></th>
        <td width="200">39.428,63</td>
        <th width="40"><strong>14</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>24</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>5</strong></th>
        <td width="200">39.440,03</td>
        <th width="40"><strong>15</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>25</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>6</strong></th>
        <td width="200">39.451,43</td>
        <th width="40"><strong>16</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>26</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>7</strong></th>
        <td width="200">39.462,83</td>
        <th width="40"><strong>17</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>27</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>8</strong></th>
        <td width="200">39.474,24</td>
        <th width="40"><strong>18</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>28</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>9</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>19</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>29</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"><strong>10</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>20</strong></th>
        <td width="200">39.485,65</td>
        <th width="40"><strong>30</strong></th>
        <td width="200">39.485,65</td>
        </tr>
        <tr>
        <th width="40"></th>
        <td width="200"></td>
        <th width="40"></th>
        <td width="200"></td>
        <th width="40"><strong>31</strong></th>
        <td width="200"></td>
        </tr>
        </tbody>
        </table>
    </div>

    <div class="test-section">
        <h3>Expected Behavior After Fix</h3>
        <p>The table should be extracted with:</p>
        <ul>
            <li><strong>Header Row:</strong> "Septiembre" spanning all 6 columns</li>
            <li><strong>Data Rows:</strong> 6 columns showing day numbers and values</li>
            <li><strong>Last Row:</strong> Should be preserved even with some empty cells (partial month)</li>
            <li><strong>NO aggressive cleanup:</strong> All 6 columns should be preserved</li>
        </ul>
        
        <p><strong>Before Fix:</strong> Table was being shown as empty due to aggressive cleanup</p>
        <p><strong>After Fix:</strong> Table should show all the numerical data properly</p>
    </div>

    <div class="test-section">
        <h3>Additional Complex Tables for Testing</h3>
        
        <h4>Table with rowspan:</h4>
        <table>
            <tr>
                <th rowspan="2">Product</th>
                <th colspan="2">Q1</th>
                <th colspan="2">Q2</th>
            </tr>
            <tr>
                <th>Sales</th>
                <th>Target</th>
                <th>Sales</th>
                <th>Target</th>
            </tr>
            <tr>
                <td>Widget A</td>
                <td>100</td>
                <td>120</td>
                <td>110</td>
                <td>130</td>
            </tr>
            <tr>
                <td>Widget B</td>
                <td>85</td>
                <td>90</td>
                <td>95</td>
                <td>100</td>
            </tr>
        </table>
        
        <h4>Table with mixed colspan/rowspan:</h4>
        <table>
            <tr>
                <th colspan="4">Financial Summary</th>
            </tr>
            <tr>
                <th rowspan="2">Region</th>
                <th colspan="2">Revenue</th>
                <th rowspan="2">Growth</th>
            </tr>
            <tr>
                <th>2024</th>
                <th>2025</th>
            </tr>
            <tr>
                <td>North</td>
                <td>$1.2M</td>
                <td>$1.5M</td>
                <td>25%</td>
            </tr>
            <tr>
                <td>South</td>
                <td>$800K</td>
                <td>$950K</td>
                <td>19%</td>
            </tr>
        </table>
    </div>

    <div class="test-section">
        <h3>ðŸ”§ Testing Instructions</h3>
        <ol>
            <li>Open the TableLens extension</li>
            <li>Click "ðŸ“‘ Extract All Tables"</li>
            <li>You should see 3 tables detected</li>
            <li>Open the September calendar table (first one)</li>
            <li>Verify it shows all 6 columns with proper data</li>
            <li>Check that the "Septiembre" header is preserved</li>
            <li>Ensure no data is missing</li>
        </ol>
        
        <p><strong>Success Criteria:</strong></p>
        <ul>
            <li>âœ… September table shows 6 columns (not empty)</li>
            <li>âœ… All numerical values are visible</li>
            <li>âœ… "Septiembre" header is preserved</li>
            <li>âœ… Complex table structures are handled correctly</li>
        </ul>
    </div>
</body>
</html>